\documentclass{article}
\usepackage[margin=0.6in]{geometry}
\usepackage[utf8]{inputenc}
\usepackage{physics}
\usepackage{graphicx}
\usepackage{siunitx}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage[dvipsnames]{xcolor}
\usepackage[sort&compress]{natbib}
%\usepackage{natbib}
\usepackage{bm}
\usepackage{url}
\usepackage{hyperref}
\usepackage{parskip}
\usepackage{lineno}
\usepackage{float}
\usepackage{gensymb}
\linenumbers

\setlength\parindent{0pt}
\renewcommand{\baselinestretch}{1.5}

\usepackage{authblk}

\title{Optimal time-dependent deployments of climate control technologies}
\author[1,2]{Henri F. Drake\textsuperscript{*}}
\author[1]{Ron Rivest}
\author[1]{Alan Edelman}
\author[1]{John Deutch}
\affil[1]{Massachusetts Institute of Technology, Cambridge, MA, USA}
\affil[2]{Woods Hole Oceanographic Institution, Woods Hole, MA, USA}

\date{}             %% if you don't need date to appear
\setcounter{Maxaffil}{0}
\renewcommand\Affilfont{\itshape\small}

\begin{document}
\maketitle

\section{Introduction}



\section{Model formulation}

Here, we describe the formulation of our optimization model framework, which consists of a physical energy balance model of Earth's climate and an idealized model of climate controls (emissions reductions, negative emissions, adaptation, and non-carbon geoengineering), which act to reduce the damages caused by a changing climate but carry their own deployment cost (including research and development costs, deployment costs, political costs, costs of side-effect damages, etc). The model is designed to include key features of climate physics, economics, and policy as concisely as possible and in ways consistent with both fundamental theory and more comprehensive models (both physical general circulation models and climate-economic integrated assessment models). Our goal is to construct a model which yields fundamental insights into optimal management of climate change but is significantly more accessible, transparent, flexible, and computationally inexpensive than conventional models. The model is developed in open source using the Julia programming language \citep{bezanson_julia:_2017} at \text\href{github.com/hdrake/OptimizeClimate}{github.com/hdrake/OptimizeClimate} (Drake et al., 2020).

\subsection{CO$_{2}$ concentrations: baseline emissions, emissions reductions, and negative emissions}

In the absence of climate policy, we assume CO$_{2}$ concentrations in the model start at $c_{0}(t_{0}) = \SI{415}{ppm}$ in $t_{0}=2020$ and increase according to a baseline emissions scenario $q(t)$ (in ppm/year). The baseline concentrations are given by the accumulation of emissions in the atmosphere,
\begin{equation}
c_{0}(t) = c_{0}(t_{0}) + \int_{t'=t_{0}}^{t} q(t') \text{ d}t'.
\end{equation}
The model currently has no explicit carbon cycle: baseline emissions are instead interpreted as the roughly 40\% of emissions which remain in the atmosphere, net of uptake by the terrestrial biosphere and the ocean \citep{}, and contribute to the greenhouse effect. A future version of the model will include an idealized but dynamic ocean carbon cycle \citep[e.g.][]{Glotter2014}, which captures both the initial linear uptake of carbon by the ocean and non-linear feedbacks due to the ocean's limited chemical buffering capacity. While we here only explicitly model CO$_{2}$ effects, other greenhouse gases may be approximated by forcing the model with the CO$_{2}$ concentrations that result in the equivalent global-mean forcing from all greenhouse gases, referred to as carbon dioxide-equivalent concentrations CO$_{2e}$. The radiative effects of aerosols and other minor anthropogenic effects, while not presently included, could similarly be prescribed as additional time-dependent global-mean forcing terms, which could themselves have associated damages (e.g. the negative health effects of airborne particulate matter) which could be reduced by abatement policies.

CO$_{2}$ emissions reductions are parameterized by the fractional reduction of annual emissions $\varphi(t) \in [0,1]$ such that the net annual emissions become $(1-\varphi(t))q$. Negative emissions are parameterized by the fraction $\phi(t) \in [0,1]$ of the baseline emissions $q(t_{0}) = \SI{5}{ppm/year}$ in 2020 that are sequestered from the atmosphere in a given year, either by direct air capture, afforestation, or otherwise \citep{}. The CO$_{2}$ concentrations in a given year are thus given by:
\begin{equation}
    c_{\varphi, \phi}(t) = c_{0}(t_{0}) + \int_{t'=t_{0}}^{t} (1-\varphi(t'))q(t') - \phi(t')q(t_{0}) \text{ d}t'.\label{eq-CO2-conc}
\end{equation}

\subsection{Temperature response}
The temperature evolution is determined by the two-box linear energy balance model \citep[e.g][]{gregory_vertical_2000, held_probing_2010}:
\begin{gather}
    c_{U} \dv{T'}{t} = -\beta T' - \gamma( T' - T_{D}') + F'(t), \label{eq.upper_ocean}
    \\
    c_{D} \dv{T_{D}'}{t} = \gamma (T' - T_{D}'),\label{eq.deep_ocean}
\end{gather}
where (\ref{eq.upper_ocean}) represents the upper ocean with a temperature anomaly $T'$ and (\ref{eq.deep_ocean}) represents the deep ocean with an average temperature $T_{D}'$. The near-surface atmosphere has a negligible heat capacity and is implicitly included in the upper ocean box, which is assumed to equilibrate rapidly with the upper ocean, such that $T'$ also represents the global-mean near-surface air temperature. The model parameters are: the upper ocean heat capacity $c_{U}$; the deep ocean heat capacity $c_{D}$; the climate feedback parameter $\beta$; the ocean mixing rate $\gamma$; and $F'(t)$ the anthropogenic CO$_{2e}$ forcing.

If the forcing $F(t)$ varies on timescales longer than the fast relaxation timescale $\tau_{U} = c_{U}/(\beta + \gamma)$ then we can ignore the time-dependence in the upper ocean and set
\begin{equation}
    T \approx \frac{F+\gamma T_{D}}{\beta + \gamma},
\end{equation}
where the evolution of the deep ocean
\begin{equation}
    c_{D} \dv{T_{D}}{t} \approx - \frac{\beta \gamma}{\beta + \gamma} T_{D} + \frac{\gamma}{\beta + \gamma} F
\end{equation}
occurs on a slow time scale $\tau_{D} \equiv \frac{c_{D}}{\beta} \frac{\beta + \gamma}{\gamma}$.

% We assume the thermal heat capacity of the climate system is sufficiently small such that $T'(t)=F(t)/B$ at all times (equivalently, that ocean heat uptake is negligible in Earth's energy budget). We determine the sensitivity parameter $B$ by tuning it to the best-guess estimate of the equilibrium climate sensitivity $T_{\text{ECS}} = F_{2\times}/B = \SI{3}{\celsius}$, where $F_{2\times} \approx \SI{3.7}{W/m^{2}}$. Since $B = F_{2\times}/T_{\text{ECS}} = F'(t)/T'(t)$, we have $T'(t) = T_{\text{ECS}} \frac{F'(t)}{F_{2\times}}$. The greenhouse gas forcing due to CO$_{2}$ is well known to be a logarithmic function of concentration, $F'(t)-F'(t_{0}) = F'(t) = b \ln(\frac{c(t)}{c(t_{0})})$.

The baseline temperature response to the baseline CO$_{2}$ concentrations is 
\begin{equation}
    T_{0}(t) = T_{0}(t_{0}) + T_{0}'(t) =  
    T_{0}(t_{0}) + 
    \frac{T_{\text{ECS}}}{\ln(2)} \ln(\frac{c_{0}(t)}{c_{0}(t_{0})}) = 
    T_{0}(t_{0}) + 
    \epsilon \ln(\frac{c_{0}(t)}{c_{0}(t_{0})}),
\end{equation}
where $\epsilon \equiv T_{\text{ECS}} / \ln(2)$ is the transient warming parameter and $T_{0}(t_{0})$ is the historical temperature change between a preindustrial 1850â€“1900 mean and present.

For the controlled CO$_{2}$ concentration scenario $c_{\varphi,\phi}(t)$ the temperature change is given by
\begin{equation}
    T_{\varphi,\phi}(t) = T_{0}(t_{0}) + T_{\varphi, \phi}'(t) =
    T_{0}(t_{0}) + 
    \frac{T_{\text{ECS}}}{\ln(2)} \ln(\frac{c_{\varphi,\phi}(t)}{c_{0}(t_{0})}) = 
    T_{0}(t_{0}) + 
    \epsilon \ln(\frac{c_{\varphi,\phi}(t)}{c_{0}(t_{0})}).
\end{equation}


The temperature response can be further modified by solar radiation management or solar geongineering, which is parameterized by reducing the emissions-controlled temperature response $T_{\varphi,\phi}$ by a fraction $\lambda(t) \in [0,1]$, such that the controlled temperature response is given by:
\begin{equation}
    T_{\varphi, \phi, \lambda} = \left(
    T_{0}(t_{0}) + 
    \epsilon \log(\frac{c_{\varphi,\phi}(t)}{c_{0}(t_{0})}) 
    \right) (1 - \lambda(t)).
\end{equation}

A more realistic model would include the transient effects of ocean heat uptake which delay the approach to equilibrium \citep{Held2014} (this implementation is \textcolor{blue}{\href{https://github.com/hdrake/OptimizeClimate/tree/two-box-temperature}{currently in development}}).

\subsection{Climate damages}

Annual climate damages are assumed to be of the quadratic form $D(t) = \beta T(t)^{2}$, such that successive temperature increases are increasingly damaging. The default value of the damage parameter $\beta$ is chosen to be roughly similar to the DICE model for low levels of warming \citep{Nordhaus}, resulting in damages of 2\% of global world product at \SI{2}{\celsius}. The baseline climate damages are thus
\begin{equation}
    D_{0}(t) = \beta T_{0}(t)^{2}.
\end{equation}
Adaptation to climate change impacts (e.g. building sea walls, installing air conditioning units, planting climate-resilient crops) is parameterized by reducing annual damages by a fraction $\chi(t) \in [0,1]$, such that the total controlled damages are:
\begin{equation}
    D_{\varphi, \phi, \lambda, \chi} = \beta \; (T_{\varphi, \phi, \lambda}(t))^{2} \; (1-\chi(t)).
\end{equation}

\subsection{Control costs}

The annual costs of climate control technologies are given by
\begin{equation}
    C(t) = \sum_{\alpha \in \mathcal{A}} C_{\alpha} f(\alpha(t)),
\end{equation}
where $\mathcal{A} = \{ \varphi, \phi, \lambda, \chi \}$ is the set of climate control technologies considered here, $C_{\alpha}$ is the reference cost of each climate control technology, and $f(\alpha)$ is a function that determines how the deployment cost increases as a function of fractional deployment. The reference cost corresponds to the hypothetical cost of full deployment of that technology (e.g. offsetting all potential warming since preindustrial with geoengineering), but it may be more usefully tuned based on a smaller deployment threshold, such as 25\%, for which costs estimates are likely to be more reflective of both plausible short-term deployment fractions and costs. Here, we will focus on the medium deployment cost scenario $f_{\text{med}}(\alpha) = \alpha^{2}$, which has the following convenient properties: 
\begin{itemize}
    \item $\left. \dv{f}{\alpha}\right|_{\alpha=0} = 0$ (initial marginal deployment is effectively free),
    \item $f(1) = 1$ (full deployment costs $C_{\alpha}$), and
    \item $\dv[2]{f}{\alpha} > 0$ (convex, such that deployment gets progressively more and more expensive).
\end{itemize}
We also leave open the possibility of alternative control cost scenarios, but do not explore them further here: concave cost scenarios such as $f_{\text{concave}}(\alpha) = 1-\exp{-3\alpha}$ that represent industry learning or scaling effects (as observed in past decades for photo-voltaic solar panels), mixed scenarios which transition from convex to concave such as $f_{\text{mixed}}(\alpha) = 
\left( \frac{\alpha}{1 + \alpha} \right)^{2}$, or the representation of start-up costs that discourage non-zero but small deployments such as $f_{\text{start-up}}(\alpha) = \varepsilon +  \alpha^{2}$ (where $\varepsilon \ll 1$).

\subsection{Total costs and discounting}

The total annual costs of climate change are the sum of the (uncontrolled or controlled) climate damages and the costs of control technologies. A common economic assumption is that society discounts future costs relative to present costs by a multiplicative factor $\mathcal{H}(t-t_{0})(1 + \rho)^{-(t-t_{0})}$, determined by the utility discount rate $\rho$ and where $\mathcal{H}(t)$ is the Heaviside step function. The discounted total cost (in dollars) of climate change from $t_{0}$ to $t_{f}$ is thus given by:
\begin{equation}
    \mathcal{T} =
    \int_{t'=t_{0}}^{t_{f}}
    (C(t') + D_{\mathcal{A}}(t')) (1 + \rho)^{-(t'-t_{0})} \text{ d}t'
\end{equation}

In contrast to typical Integrated Assessment Models, which follow classic economic theories of optimal economic growth and solve for the maximal welfare based on the discounted utility of consumption, we here completely ignore economic feedbacks and simply aim to minimize the total discounted cost of climate change. Here, the total discounted cost of climate change include both the direct cost of damages from climate impacts (e.g. increased mortality from heat waves or property damage from higher storm surges) and the indirect cost of deploying climate controls which aim to alleviate the direct costs of climate impacts. The goal is to find the trajectories of control deployments which optimize the trade-off between the costs of climate impacts and control deployments.

One argument in favor of this simplified approach to the economics is the apparent insensitivity of economic output and consumption to climate policies in IAMs such as the DICE2013 model \cite[][figures 2 and 3]{Nordhaus}.

\subsection{Optimization Methods}

We use the Interior Point Optimizer (\href{https://github.com/coin-or/Ipopt}{https://github.com/coin-or/Ipopt}), an open source software package for large-scale nonlinear optimization, to minimize various objective functions which correspond to different perspectives on climate policy.

\subsubsection{Minimizing discounted total costs (including both controlled damage costs and the costs of controls)}

The optimization problem is:
\begin{align}
    && \min_{\alpha \in \mathcal{R}} \{ \mathcal{T} \} = \min_{\alpha \in \mathcal{R}} \left\{
    \int_{t'=t_{0}}^{t_{f}}
    (C(t') + D_{\mathcal{A}}(t')) (1 + \rho)^{-(t'-t_{0})} \text{ d}t' \right\},
    \\
    & \text{s.t. }
    & 0 \leq \alpha \leq 1\quad \text{and}\\
    && \abs{\pdv{f_{\alpha}(\alpha(t))}{t}} < \frac{1}{30\text{ years}}.
\end{align}

\subsubsection{Minimizing total control costs subject to a temperature goal (e.g. Paris Agreement)}

The optimization problem is:
\begin{align}
    & & \min_{\alpha \in \mathcal{R}} \{ \mathcal{T} \} = \min_{\alpha \in \mathcal{R}} \left\{
    \int_{t'=t_{0}}^{t_{f}}
    C(t') (1 + \rho)^{-(t'-t_{0})} \text{ d}t' \right\},
    \\
    & \text{s.t. }
    & T_{\varphi, \phi, \lambda}(t) < T_{\text{goal}},\\
    && 0 \leq \alpha \leq 1\text{, and}\\
    &&\abs{\pdv{f_{\alpha}(\alpha(t))}{t}} < \frac{1}{30\text{ years}},
\end{align}
where $T_{goal}$ is the goal temperature.

\subsubsection{Minimizing controlled damage costs subject to a fixed budget for controls}

\begin{align}
    & & \min_{\alpha \in \mathcal{R}} \{ \mathcal{T} \} = \min_{\alpha \in \mathcal{R}} \left\{
    \int_{t'=t_{0}}^{t_{f}}
    D_{\mathcal{A}}(t') (1 + \rho)^{-(t'-t_{0})} \text{ d}t' \right\},\\
    & \text{s.t. }
    & \int_{t'=t_{0}}^{t_{f}}
    C(t') (1 + \rho)^{-(t'-t_{0})} \text{ d}t' < \mathcal{B},\\
    &&0 \leq \alpha \leq 1\text{, and}\\
    &&\abs{\pdv{f_{\alpha}(\alpha(t))}{t}} < \frac{1}{30\text{ years}},
\end{align}
where $\mathcal{B}$ is a fixed discounted budget for controls.

%\bibliographystyle{apalike}
%\bibliography{references.bib}

\end{document}